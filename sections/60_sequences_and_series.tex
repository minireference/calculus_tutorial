%!TEX root = ../calculus_tutorial.tex

\section{Sequences and series}
\label{sec:sequences_and_series}

	A \emph{sequence} $a_k$ is a function that take natural numbers as inputs
	and produce real numbers as outputs: $a_k : \mathbb{N} \to \mathbb{R}$.
	The \emph{series} $\sum a_k$ describes the sum of all the terms in the sequence $a_k$.
	%
	Sequences and series are the third pillar of the basic calculus knowledge that I want you to have
	because they are powerful computational tools  
	that allow us to describe procedures with infinite number of steps.

	\subsection{Sequences are functions with discrete inputs}
	\label{sequences_and_series:sequences}

		We use the notation $f: \mathbb{R} \to \mathbb{R}$
		to describe functions that take real numbers $x \in \mathbb{R}$ as inputs
		and produce real numbers as outputs $f(x) \in \mathbb{R}$.
		When studying functions that take natural numbers $k \in \mathbb{N}$ as inputs,
		we use a different notation: $a_k: \mathbb{N} \to \mathbb{R}$,
		where $a_k$ describes the $k$\textsuperscript{th} term in the sequence.
		The sequence's input variable is usually denoted~$k$
		and corresponds to the \emph{index} within the sequence.
		Usually $k$ is a natural number $k \in \mathbb{N} \eqdef \{0,1,2,3,4,\ldots\}$
		but some sequences are only defined for positive natural numbers
		$k \in \mathbb{N}_+ \eqdef \{1,2,3,4,\ldots\}$.
		Note the chance in notation:
		we use subscript to denote the input variable of a sequence $a_k$
		instead of the usual notation for functions $a(k)$.
		
		We can define a sequence by specifying the formula for the $k$\textsuperscript{th} term in the sequence.
		For example,
		the \emph{harmonic sequence} is defined by the formula $h_k \eqdef \frac{1}{n}$.
		Another way to define a sequence is by listing the first few values in the sequence:
		$[h_0, h_1, h_2, h_3, \ldots]$,
		which correspond to evaluating formula $h_k$ for $k=0$, $k=1$, $k=2$, $k=3$, etc.
		We'll now look at some examples of sequences,
		specifying both their formulas
		and showing the the first few values of each sequence.


		\paragraph{The natural numbers}
		
			The simplest possible example of a sequence is the identity function,
			which returns the index input $k$ as output:
			\[
				n_k\eqdef k, \text{ for } k \in \mathbb{N}
				  \ \ \Leftrightarrow \ \ 
				  \left[0, 1, 2, 3, 4, 5, 6, 7, \ldots \, \right].
			\]
			This is the fundamental counting sequence that describes
			the process of taking a ``unit step'' to the right on the number line,
			starting at the origin.
		

		\paragraph{Squares of natural numbers}
			
			The sequence-equivalent of the quadratic function $f(x)=x^2$
			is the sequence of squares of the natural numbers:
			\[
				q_k\eqdef k^2, \text{ for } k \in \mathbb{N}
				  \ \ \Leftrightarrow \ \ 
				  \left[0, 1, 4, 9, 16, 25, 36, 49, \ldots \, \right].
			\]


		\paragraph{Harmonic sequence}
			
			We obtain another useful sequence by computing the fractions $\frac{1}{k}$
			for each $k \in \{1,2,3,\ldots\} = \mathbb{N}_+$:
			\[
				h_k\eqdef \tfrac{1}{k}, \text{ for } k \in \mathbb{N}_+
				  \ \ \Leftrightarrow \ \ 
				  \big[1, \tfrac{1}{2}, \tfrac{1}{3}, \tfrac{1}{4}, \tfrac{1}{5}, \tfrac{1}{6}, \tfrac{1}{7}, \ldots \, \big].
			\]
			This is called the \emph{harmonic sequence}
			because it describes the wavelengths of harmonic frequencies produced by musical instruments.
			% For most music instruments,
			When we play the note that corresponds to the frequency $f$,
			we also hear notes with frequencies that are integer multiple of the ``dominant'' frequency:
			$2f$, $3f$, $4f$, etc.,
			which are called the harmonics.
			The harmonic sequence describes the wavelengths of the harmonics frequencies.
			On a string instrument,
			the harmonic sequence tells you where to place your fingers if you want to play higher harmonics.
			%	The harmonic series is a really old concept,
			%	since it is a common 			
			%	that was well known by ancient civi Greeks knew about it
			%	played by the instrument consists of a ``main vibration'' with 
			%	Most music instrument that produce a given note and higher harmonics,
			%	which are frequencies 
			%	each note played by a musical instrument has a ``dominant'' frequency


		\paragraph{The alternating harmonic sequence}
	
			Consider now a harmonic sequence with alternating positive an negative terms:
			\[
				a_k \eqdef \tfrac{(-1)^{k+1}}{k}, \text{ for } k \in \mathbb{N}_+
				  \ \ \Leftrightarrow \ \ 
				  \big[ 1, -\tfrac{1}{2}, \tfrac{1}{3}, -\tfrac{1}{4}, \tfrac{1}{5}, -\tfrac{1}{6}, \tfrac{1}{7}, \ldots \, \big].
			\]
			The factor $(-1)^{k+1}$ is positive for all odd inputs $k \in \{1,3,5,7,\ldots \}$
			since $(-1)^m=+1$ for any even number $m$.
			The factor $(-1)^{k+1}$ is negative
			for all even indices $k \in \{2,4,6,8,\ldots \}$,
			hence the values in the sequence oscillate between positive and negative.


		\paragraph{Inverse factorial sequence}

			The factorial function is denoted~$k!$
			and describes the product of the first $k$ positive natural numbers:
			$k! \;\; \eqdef \;\; k \cdot (k-1) \cdots 3 \cdot 2 \cdot 1$.
			We'll see factorials in several formulas in this section.
			In particular,
			the following sequence will be of interest:
			\[
				f_k\eqdef \tfrac{1}{k!}, \text{ for } k \in \mathbb{N}_+
				  \ \ \Leftrightarrow \ \ 
				  \big[ 1, \tfrac{1}{2!}, \tfrac{1}{3!}, \tfrac{1}{4!}, \tfrac{1}{5!}, \tfrac{1}{6!}, \tfrac{1}{7!}, \ldots \, \big].
				% WHY NOT START AT 0 ?		TODO
			\]
			The values in the inverse factorial sequence quickly become very small
			because the factorial function grows very quickly:
			$2!=2$,
			$3!=6$,
			$4!=24$,
			$5!=120$,
			$6!=720$,
			$7! = 5040$, \ldots,
			$10! = 3628800$, \ldots, 
			$13! \approx 6.2 \times 10^9$, \ldots, 
			$70! \approx 1.2 \times 10^{100}$,
			etc.
			% This sequence is a will be ingredient in power-series expansions such as the exponential function.


		\paragraph{Geometric sequence}

			The sequences-equivalent of the exponential function $f(x) = e^x$
			is the \emph{geometric sequence}
			where the $k$\textsuperscript{th} value in the sequence
			is the $k$\textsuperscript{th} powers of some number $r$:
			\[
				g_k\eqdef r^k, \text{ for } k \in \mathbb{N}
				  \ \ \Leftrightarrow \ \ 
				  \big[ 1, r, r^2, r^3, r^4, r^5, r^6, r^7, \ldots \, \big].
			\]
			Each term in the sequence equals $r$ times the previous term,
			which describes a \emph{geometric} process that repeatedly grows/shrinks by the amount $r$.
			When $r < 1$,
			the values in the sequence $g_k$ quickly go to zero,
			similar to how exponential function $e^{-x}$ goes to zero for large value of $x$.
			When $r > 1$ the sequence $g_k$ increases quickly,
			similar to how exponential function $e^{x}$ increases for large value of $x$.


		\paragraph{Powers of two}

			We'll also use the label $b_k$
			for the special case of the geometric series with $r=2$:
			\[
				b_k \eqdef 2^k, \text{ for } k \in \mathbb{N}
				  \ \ \Leftrightarrow \ \ 
				  [ 1, 2, 4, 8, 16, 32, 64, 128, \ldots \, ].
			\]
			This sequence comes up all over the placeÂ in computer science
			because it is describes the number of different numbers we can store in $k$ bits of memory.



	\subsection{Convergence of sequences}
	\label{sequences_and_series:convergence_of_sequences}
	
		What happens to a sequence as $k$ goes to infinity?
		We can use the limit notation $\lim_{k \to \infty}$ to describe this process.
		There are two behaviours we're interested in:
		sequences that blow up to infinity,
		and sequences that approach some fixed number as $k$ goes to $\infty$.

		For example,
		the sequences $n_k \eqdef k$, $q_k \eqdef k^2$, and $b_k \eqdef 2^k$
		keep getting larger and larger as $k$ goes to infinity:
		\[
			%\lim_{k \to \infty} n_k = 
			\lim_{k \to \infty} k = \infty,
			\qquad
			% \lim_{k \to \infty} q_k = 
			\lim_{k \to \infty} k^2 = \infty,
			\qquad
			% \lim_{k \to \infty} b_k = 
			\lim_{k \to \infty} 2^k = \infty.
		\]
		We say these sequences are \emph{divergent}.
		%
		In contrast,
		the values in the sequences $h_k \eqdef \tfrac{1}{k}$,
		$a_k \eqdef \tfrac{(-1)^{k+1}}{k}$,
		and $f_k \eqdef \tfrac{1}{k!}$ \emph{converge}
		to the value $0$ in the limit as $k$ goes to infinity:
		\[
			% \lim_{k \to \infty} h_k =
			\lim_{k \to \infty} \tfrac{1}{k} = 0,
			\qquad
			\lim_{k \to \infty} \tfrac{(-1)^{k+1}}{k} = 0,
			\qquad
			% \lim_{k \to \infty} f_k =
			\lim_{k \to \infty} \tfrac{1}{k!} =  0.
		\]
		The geometric series $g_k \eqdef r^k$
		converges only if the absolute value of $r$ is less than one:
		$\lim_{k \to \infty} r^k = 0$, when $|r| < 1$.

		The limit of a sequence as $k$ goes to infinity
		is directly analogous to the limit of function $f(x)$ as $x$ goes to infinity.


	\subsection{Summation notation}
	\label{sequences_and_series:summation_notation}
	
		We're often interested in computing sums of values in a sequence.
		To describe the sum of 3\textsuperscript{rd}, 4\textsuperscript{th}, and 5\textsuperscript{th}
		elements of the sequence $c_k$,
		we turn to summation notation: $\sum_{k=3}^{5} c_k	= c_3 + c_4 + c_5$.
		The capital Greek letter \emph{sigma} stands in for the word \emph{sum}, 
		and the range of index values included in this sum is denoted below and above the summation sign.
		%
		The sum of the values in the sequence $c_k$ from $k=0$ until $k=n$
		is denoted as $\sum_{k=0}^n c_k =  c_0 + c_1 + c_2 + \cdots + c_{n-1} + c_n$.
		% This is called \emph{finite series} 

		Since this is a calculus tutorial,
		you should expect that an infinity of some kind will show up,
		and indeed we'll soon learn about \emph{infinite series}
		that describe the sum of \emph{all} the values in the sequence $c_k$:
		$\sum c_k  \eqdef 	\lim_{n \to \infty} \sum_{k=0}^n c_k$.
		% =		\sum_{k=0}^\infty c_k = c_0+ c_1 + c_2 + c_3 + c_4 + \cdots .
		%	In calculus,
		%	the notion of a \emph{series} describes the sum of \emph{all} the values in the sequence $c_k$:
		%	\[
		%	   \sum c_k 
		%	    	\eqdef 	\lim_{n \to \infty} \sum_{k=0}^n c_k
		%		=		\sum_{k=0}^\infty c_k = c_0+ c_1 + c_2 + c_3 + c_4 + \cdots .
		%	\]
		%	Note if the sequence $c_k$ continues indefinitely,
		%	computing the sum requires an infinite number of addition operations.
		%
		%
		But before we get to infinite sums,
		we'll start by looking at some finite sums
		to gain some experience with the summation notation.


	\subsection{Exact formulas for finite summations}
	% WAS Exact sums

		We'll now show some useful formulas for calculating sum of the terms in certain sequences.
		For example,
		here is a formula for the sum of the first $n$ terms in the geometric sequence:
		\[
			% \sum_{k=0}^n g_k=
			G_n = 
			\sum_{k=0}^n r^k 
				= 1 + r + r^2 + \cdots + r^n 
				= \frac{1-r^{n+1}}{1-r}.
		\]
		We can use this formula to find the sum of the powers of $2$:
		\[
		   \sum_{k=0}^n 2^k = 1 + 2 + 4 + 8 + \cdots + 2^n = \frac{1-2^{n+1}}{1-2} = 2^{n+1} -1.
		\]


		The sum of the first $n$ positive integers and the sum of their squares
		are described by the following formulas:
		\[
			\sum_{k=1}^n k = \frac{n(n+1)}{2}
			\qquad \text{and} \qquad
			\sum_{k=1}^n k^2=\frac{n(n+1)(2n+1)}{6}.
		\]
		% MAYBE add k^3 formula too?
		% 	See problem \textbf{P\ref{problem:infinite_sum_formulas_derivation}}
		%	for the derivations of these formulas.

		\ifthenelse{\boolean{FORSTATSBOOK}}{
			% COMBINATIONS AND THE BINOMIAL COEFFICIENT
			The \emph{binomial coefficient} is denoted using the symbol ${n \choose k}$,
			which is read as ``$n$ choose $k$.''
			The binomial coefficient counts the number of combinations of $k$ items
			we can choose from a set of $n$ items,
			and it is computed using the formula:
			${n \choose k} \eqdef \frac{n!}{(n-k)! \, k!}$.
			% ALT. set of $n$ items and we want to choose $k$ of them
			For example,
			the number of combinations of size $2$ selected from a list of $5$ items is 
			${5 \choose 2}	= \frac{5!}{(5-2)!\,2!} = \frac{5!}{3!\,2!}
						= \frac{5\cdot 4 \cdot 3 \cdot 2 \cdot 1}{3 \cdot 2 \cdot 1 \;\; \cdot \;\; 2 \cdot 1  } 
						= \frac{120}{6 \cdot 2} = 10$.
			%	We can use the function \tt{comb(n,k)} from the \tt{scipy.special} module
			%	to compute ${n \choose k}$.
			%	Here is the code for computing ${5 \choose 2}$.
			%	\begin{codeblock}[calc-comb-5-2]
			%	>>> from scipy.special import comb
			%	>>> comb(5,2)  # == "n choose k"
			%	10
			%	\end{codeblock}
			The binomial coefficient
			appears in the expansion of the binomial expression $(a + b)^n$,
			which can written as the following summation:
			\begin{align*}
				(a+b)^n	&= \textstyle {n \choose 0}a^n
							+ {n \choose 1}a^{n-1}b 
							% + {n \choose 2}a^{n-2}b^2
							+ \cdots
							+ {n \choose n-1 }ab^{n-1}
							+ {n \choose n}b^n	\\
						&= \textstyle \sum_{k=0}^n {n \choose k} a^{n-k} b^k.
			\end{align*}
			This sum appears in several calculations in probability theory.
			%	In the special case when one of the terms is 1:
			%	\[
			%		\sum_{k=0}^n {n \choose k} x^k=(1+x)^n
			%	\]

			% The binomial coefficient also appears in various calculations in probability theory.
			%	we use the ``$n$ choose $k$'' formula to calculate certain probabilities
			%	by counting the combinations of outcomes that produce a certain event.
			%	For example,
			%	the probability of exactly $2$ heads in $5$ coin tosses is ${5 \choose 2}0.5^5$.
		}{}





	\subsection{Series}

		% Series are sums of sequences.
		Series are defined as the sums computed from the terms in the sequence $c_k$.
		The \emph{finite series} $\sum_{k=1}^n c_k$ computes the first $n$ terms of the sequence:
		\[
			C_n = \sum_{k=1}^n c_k
				= c_1 + c_2 + c_3 + c_4 + c_5  + \cdots  + c_{n-1} + c_n.
		\]
		The \emph{infinite series} $\sum c_k$ computes \emph{all} the terms in the sequence:
		\[
			C_\infty	= \sum c_k
					= \lim_{n\to \infty}  \sum_{k=1}^n c_k
					= c_1 + c_2 + c_3 + c_4 + c_5 + \cdots.
		\]
		%	and we want to compute the sum of all the values in this sequence $\sum_{k=-}^\infty c_k$.
		The infinite series $\sum c_k$
		of the sequence $c_k : \mathbb{N} \to \mathbb{R}$
		is analogous to the integral $\int_0^\infty f(x) \,dx$
		of a function $f : \mathbb{R} \to \mathbb{R}$.
		
		Some infinite series converge to a finite value.
		For example,
		when $|r|<1$,
		the limit as $n \to \infty$ of the geometric series converges to the following value:
		\[
			G_\infty 
				= \lim_{n \to \infty} G_n 
				= \sum_{k=0}^\infty r^k
				= 1 + r + r^2 +  r^3 + \cdots 
				= \frac{1}{1-r}.
		\]
		This expression describes an infinite sum,
		which is not possible to compute in practice,
		but we can see the truth of this equation using our mind's eye.
		The formula for first $n$ terms is the geometric series is $G_n = \frac{1-r^{n+1}}{1-r}$.
		The term $r^{n+1}$ goes to zero as $n \to \infty$,
		so the only part of the formula that remains is $\frac{1}{1-r}$.

		\paragraph{Example 1: sum of a geometric series}

			Let's use the formula to compute infinite series
			of the geometric sequence with $r=\frac{1}{2}$:
			\[
				\sum_{k=0}^\infty \big(\tfrac{1}{2}\big)^k
					= 1 + \tfrac{1}{2} + \tfrac{1}{4} + \tfrac{1}{8} + \tfrac{1}{16} + \tfrac{1}{32} + \cdots 
					=\frac{1}{1-\frac{1}{2}} = 2.
			\]
			Figure~\ref{fig:geometric_progression_of_one_half}
			shows a visualization for this infinite sum.
	
			\begin{figure}[htb]
				\centering
				\includegraphics[width=0.69\columnwidth]{figures/calculus/geometric_progression_of_one_half.png}
				\caption{	A graphical representation of the infinite sum of the geometric series with $r=\frac{1}{2}$.
						The area of each region corresponds to one of the terms in the series.
						The total area is equal to $\sum_{k=0}^\infty (\frac{1}{2})^k=\frac{1}{1-\frac{1}{2}}=2$.}
				\label{fig:geometric_progression_of_one_half}
			\end{figure}

		\noindent
		That's kind of cool, no?
		We're able to compute the value of a summation with infinitely meany terms,
		because we have the general pattern $G_n$ for the sum with $n$ terms
		then evaluate the limit as $n$ goes to infinity.


	\subsubsection{Convergent and divergent series}

		We say the geometric series $G_\infty = \sum g_k = \sum_{k=0}^\infty r^k$ \emph{converges}
		to the value $\frac{1}{1-r}$.
		We can also say that the infinite geometric series $\sum g_k$ \emph{is convergent},
		meaning it has a finite value and doesn't blow up.
		Another example of a converging infinite series is $F_\infty = \sum f_k$,
		which converges to the number $e$,
		as we'll see in Example~2 below.

		In contrast,
		the harmonic series $\sum h_k$ \emph{diverges}.
		When we sum together more and more terms of the sequences $h_k$,
		the total computed keeps growing and the infinite series blows up to infinity
		$\sum h_k = \infty$.
		We say that the harmonic series \emph{is divergent}.
		


%	and the inverse factorial series $F_k = \sum f_k	$ converges (or ).
%	As we sum together more and more terms of the sequences $g_k$ and $f_k$,
%	the total becomes closer and finite numbers.
%	In this case,
%	of $G_\infty$ we conserve to the faction $\frac{1}{1-r}$,
%	while the infinite sum $\sum_{k=0}^\infty \frac{1}{k!}$
%	converges to the number $e=2.71828\ldots$.
%	The alternating harmonic series $\sum a_k$ converges to the value $\ln(2)$.

			%	In words,
			%	we say infinite sum $\sum_{k=0}^\infty \frac{1}{k!}$
			%	converges to the number $e=2.71828\ldots$

	\subsubsection{Using convergent series for practical calculations}

		We can use infinite series to compute irrational numbers.

		\paragraph{Example 2: Euler's number}
			
			The infinite sum of the sequence $f_k \eqdef \tfrac{1}{k!}$
			converges to Euler's number $e = 2.71828182845905\ldots$:
			\[
				F_\infty 
					= \lim_{n \to \infty} F_n 
					= \sum_{k=0}^\infty \tfrac{1}{k!}
					= 1 + 1 + \tfrac{1}{2} + \tfrac{1}{6} + \tfrac{1}{24} + \tfrac{1}{720} + \cdots
					= e.
					% = 2.71828\ldots. 
			\]
		
		\noindent
		The calculation above is not just cool math fact,
		but a useful computational procedure
		that we can use to approximate the value of $e = 2.71828\ldots$
		using only basic arithmetic operations like repeated multiplication (factorial), division, and addition.

		Let's look at some practical calculations where we compute
		the first $n=10$ and $n=15$ terms in the series $\sum_{k=0}^m f_k$: 

		\begin{codeblock}[]
		>>> import math
		>>> def f_k(n): 
		        return 1 / math.factorial(n)
		>>> sum([f_k(k) for k in range(0,10)])
		2.718281...
		>>> sum([f_k(k) for k in range(0,15)])
		2.71828182845...
		\end{codeblock}

		\noindent
		Summing together the first $10$ terms in the series
		gives us an approximation to $e$ that is accurate to six decimals.
		With $15$ terms,
		we get an approximation that is accurate to $11$ decimals.
		The more terms we include in the summation,
		the closer we get to the true value of $e$,
		which is $2.71828182845905\ldots$.

		If we want to compute the \emph{exact} value of $e$,
		we would need to compute the infinite series $\sum_{k=0}^\infty \tfrac{1}{k!}$.
		We can do this using SymPy
		by calling the function \texttt{sp.summation}
		whose syntax is similar to the function \texttt{sp.integrate} we used to compute integrals.
		The first argument is an the expression for the $k$\textsuperscript{th}
		term in the sequence,
		then we specify the index variable,
		the starting point,
		and the end point of the summation:

		\begin{codeblock}[]
		>>> import sympy as sp
		>>> k = sp.symbols("k")
		>>> sp.summation(1/sp.factorial(k), (k, 0, sp.oo))
		E
		\end{codeblock}

		\noindent
		We used \tt{sp.oo} to make SymPy compute the infinite sum,
		which produced the exact symbolic answer $\tt{E} = e$.
		%The \texttt{summation} command is useful because it allows us to compute \emph{infinite} sums,

		There other series we can use to compute values of interest.

		\paragraph{Example 3}

			We can calculate the value $\ln(2)$ 
			by computing the infinite sum of the alternating harmonic sequence
			$a_k \eqdef \tfrac{(-1)^{k+1}}{k}$:
			\[
				A_\infty
					= \lim_{n \to \infty} \sum_{k=1}^n \tfrac{(-1)^{k+1}}{k}
					 = 1 - \tfrac{1}{2} + \tfrac{1}{3} - \tfrac{1}{4} + \tfrac{1}{5} - \tfrac{1}{6}  + \tfrac{1}{7} + \cdots
					= \ln(2).
			\]
			To obtain the exact value $\ln(2)$,
			we need to sum together an infinite number of terms in the series $\sum a_k$,
			but we can obtain successively better approximations
			to $\ln(2)$ using finite sums.

			\begin{codeblock}[]
			>>> def a_k(k):
			        return (-1)**(k+1) / k
			>>> sum([a_k(k) for k in range(1,100+1)])
			0.6...
			>>> sum([a_k(k) for k in range(1,1000+1)])
			0.69...
			>>> sum([a_k(k) for k in range(1,1_000_000+1)])
			0.69314...
			\end{codeblock}
			
			\noindent
			The series approximation to $\ln(2)$ converges more slowly
			that the series approximation to $e$ we saw in the previous example.
			We need to sum $1$M terms in the series to obtain
			and approximation %to $\ln(2)$
			that is accurate to five decimals.
			Nevertheless,
			if we keep calculating sums with more and more terms,
			we can obtain an approximation that is arbitrarily close
			to the true value $\ln(2) = 0.6931471805599453\ldots$.
			
			To get the exact value $\ln(2)$,
			we can make SymPy compute the infinite series:

			\begin{codeblock}[]
			>>> sp.summation((-1)**(k+1)/k, (k, 1, sp.oo))
			log(2)
			\end{codeblock}

		\noindent
		We can come up with all kinds of other infinite series expression
		for calculating other numbers.
		Instead of showing you other series for approximating numbers,
		I'll show you an even more powerful calculus technique:
		a way to approximate \emph{functions} as infinite series.



	\subsection{Power series}
	\label{series:power_series}

		The term \emph{power series} describes a series
		whose terms contain different powers of the variable $x$.
		The $k$\textsuperscript{th} term in a power series
		consists of some coefficient $c_k$
		and the $k$\textsuperscript{th} power of the variable $x$:
		\[
			P_n(x)
				= \sum_{k=0}^n c_k x^k
				= c_0 + c_1x + c_2x^2 + c_3x^3 % + c_4x^4 + c_5x^5
					+ \cdots + c_nx^n.
		\]
		The math expression we obtain in this way is a \emph{polynomial} of degree $n$ in $x$,
		which we denote $P_n(x)$.
		Depending on the choice of the coefficients $(c_0, c_1, c_2, c_3, \ldots, c_n)$
		we can make the polynomial function $P_n(x)$
		\emph{approximate} some other function $f : \mathbb{R} \to \mathbb{R}$.
		To find such approximations,
		we need some way to choose the coefficients $c_k$ of the power series,
		so that the resulting polynomial approximates the function:
		$P_n(x) \approx f(x)$.


	\subsection{Taylor series}
	\label{series:taylor_series}

		The \emph{Taylor series approximation} to the function $f(x)$
		is a power series whose coefficients $c_k$
		are computed by evaluating the $k$\textsuperscript{th} derivative of the function $f(x)$ at $x=0$,
		which we denote $f^{(k)}(0)$.
		Specifically,
		the $k$\textsuperscript{th} coefficient in the Taylor series approximation
		for the function $f(x)$ is $c_k \eqdef \frac{f^{(k)}(0)}{k!}$.
%The coefficients in the power series of a function (also known as the \emph{Taylor series})
%depend on the value of the higher derivatives of the function. 
%The formula for the $k$\textsuperscript{th} term in the Taylor series of $f(x)$ expanded at $x=c$
%is $a_k(x) = \frac{f^{(n)}(c)}{k!}(x-c)^k$,
%where $f^{(k)}(c)$ is the value of the $k$\textsuperscript{th} derivative of $f(x)$ evaluated at $x=c$.
		%
		The finite series with $n$ % such 
		terms produces the following approximation:
		\[
			f(x)
		 		\approx f(0)
					+f'(0)x
					+\tfrac{f^{\prime\prime}(0)}{2!}x^2
					% +\tfrac{f^{(3)}(0)}{3!}x^3
					+ \cdots
					+\tfrac{f^{(n)}(0)}{n!}x^n  \\
					% +\tfrac{f^{\prime\prime\prime}(0)}{3!}x^3
					% +\tfrac{f^{(4)}(0)}{4!}x^4 + \cdots \\
		 		= \sum_{k=0}^n \tfrac{f^{(k)}(0)}{k!}x^k.
		\]
		In the limit as $n$ goes to infinity,
		the approximation becomes exact:
		\[
			f(x) = f(0)
					+f'(0)x
					+\tfrac{f^{\prime\prime}(0)}{2!}x^2
					+\tfrac{f^{(3)}(0)}{3!}x^3 + \cdots \\
		 		= \sum_{k=0}^\infty \tfrac{f^{(k)}(0)}{k!}x^k.
		\]
		%	Each term in the series is of the form $a_k=c_k x^k$, 
		%	where the coefficient $c_k$ depends on the properties of the function $f(x)$.
		%	Specifically,
		%	$c_k = \frac{f^{(k)}(0)}{k!}$,
		%	where $f^{(k)}(0)$ is the $k$\textsuperscript{th} derivative of $f(x)$ and $k!$ is the factorial function:

		Using this formula and your knowledge of derivative formulas,
		you can compute the Taylor series of any function $f(x)$.
		For example,
		let's find the Taylor series of the function $f(x)=e^x$ at $x=0$.
		The first derivative of $f(x)=e^x$ is $f'(x)=e^x$.
		The second derivative of $f(x)=e^x$ is $f''(x)=e^x$.
		In fact,
		all the derivatives of $f(x)$ will be $e^x$ because the derivative of $e^x$ is equal to $e^x$.
		The $k$\textsuperscript{th} coefficient in the power series of $f(x)=e^x$ at the point $x=0$ 
		is equal to the value of the $k$\textsuperscript{th} derivative of $f(x)$ evaluated at $x=0$
		divided by $k!$.
		In the case of $f(x)=e^x$,
		we have $f^{(k)}(0)=e^0=1$,
		so the coefficient of the $k$\textsuperscript{th} term is $c_k = \tfrac{f^{(k)}(0)}{k!}  = \tfrac{1}{k!}$.
		The Taylor series of $f(x)=e^x$ is
		\[
			e^x	= \sum_{k=0}^\infty \tfrac{1}{k!}x^k
		 	 	= 1 + x + \tfrac{x^2}{2} + \tfrac{x^3}{3!} + \tfrac{x^4}{4!} + \tfrac{x^5}{5!} + \tfrac{x^6}{6!} + \tfrac{x^7}{7!}  + \cdots 
		 \]
		Taylor series are a powerful computational tool for approximating functions.
%This is, IMHO, one of the most important ideas in calculus:
%you can compute the value of $e^x$ by taking the infinite sum of the terms in the power series
		As we compute more terms from the above series,
		our the polynomial approximation to the function $f(x)=e^x$ becomes more accurate.
.

%	The exact value of the function at $x=1$ is $f(1) = e^1 = e$.
%	The partial sum of the first six terms (as shown above) gives us an approximation of $e^1$ that is accurate to three decimals. 
%	The partial sum of the first 12 terms gives us $e$ to an accuracy of nine decimals.
%	# Your calculator computes the number e as the infinite sum
%	#     e  =  1 + 1 + 1/2 + 1/3! + 1/4! + ... 
%	# where n! is the factorial function, 5!=5*4*3*2*1.
%	#--
%	# The equation for the i'th term is
%	an_e = 1.0/factorial(n)
%	#--
%	# The sum of the first 40 terms in the series is
%	summation( an_e, (n,0,40) )
%	#--
%	# The exact value of e according to the computer is:
%	#--
%	E.evalf()
%	#--

		Table~\ref{table:taylor_series} shows
		the Taylor series obtained using the formula
		$f(x) = \sum_{k=0}^\infty \frac{f^{(k)}(0)}{k!}x^k$
		for several important functions.

		\begin{table}[htb]
		\centering
		\caption{Taylor series expansions for commonly used functions}
		\begin{shadebox}%
		\vspace{-2mm}
		\begin{align*}
		% f(x)			&=	\sum_{k=0}^\infty \frac{f^{(k)}(0)}{k!}x^k		\\
		\frac{1}{1-x}	&=	\sum_{k=0}^\infty x^k
						= 1 + x + x^2 + x^3 + x^4 + x^5 + x^6 + \cdots \\
		\frac{1}{1+x}	&=	\sum_{k=0}^\infty (-x)^k
						= 1 - x + x^2 - x^3 + x^4 - x^5 + x^6 + \cdots \\
		e^x			&=	\sum_{k=0}^\infty \frac{x^k}{k!}
						= 1 + x + \frac{x^2}{2} + \frac{x^3}{3!} + \frac{x^4}{4!} + \frac{x^5}{5!} + \cdots \\
		 \sin(x)  		& = \sum_{n=0}^\infty \frac{(-1)^n}{(2n+1)!} \: x^{2n+1}
		 	  			= x - \frac{x^3}{3!}  + \frac{x^5}{5!} - \frac{x^7}{7!} % + \frac{x^9}{9!} - \frac{x^{11}}{11!} 
						+ \cdots \\
		 \cos(x)  		& = \sum_{n=0}^\infty \frac{(-1)^n }{(2n)!}\:x^{2n} 
		 				=  1 - \frac{x^2}{2} + \frac{x^4}{4!} - \frac{x^6}{6!} % +  \frac{x^8}{8!}  - \frac{x^{10}}{10!}  
						+  \cdots \\
		\!\!\ln(x+1) 		& = \sum_{n=1}^\infty \frac{(-1)^{n+1}}{n}\:x^n
		 				=  x - \frac{x^2}2 + \frac{x^3}{3} - \frac{x^4}{4} + \frac{x^5}{5}   % - \frac{x^6}{6} 
							+ \cdots 		 		
		\end{align*}%
		\end{shadebox}
		\label{table:taylor_series}
		\end{table}

		% POLYNOMIAL BASIS
		Readers who are familiar with the concept of a basis from linear algebra
		can think of the Taylor series shown in Table~\ref{table:taylor_series}
		as \emph{representations} of the corresponding functions
		with respect to the basis of polynomial functions:
		$(1, x, x^2, x^3, x^4, x^5, \ldots)$.
		The Taylor series coefficients $c_k = \tfrac{f^{(k)}(0)}{k!}$
		are the \emph{coordinates} of the function $f(x)$ in the \emph{polynomial basis}.
		

	\subsection{Obtaining Taylor series using SymPy}
	\label{series:taylor_series_using_sympy}

		The \texttt{SymPy} function \texttt{sp.series} is a convenient way to obtain the Taylor series of any function.
		Calling \texttt{series(fun,var,x0,n)} 
		will show you the series expansion of any function \texttt{fun} 
		near \texttt{var}=\texttt{x0} up to powers of \texttt{n}.
		We can quickly fact-check the Taylor series given in Table~\ref{table:taylor_series} using SymPy.
%The SymPy function series is a convenient way to obtain the series of any function fun. Calling sp.series(fun,var,x0,n) will show you the series expansion of expr near var=x0 including all powers of var less than n.

		\begin{codeblock}[]
		>>> import sympy as sp
		>>> x = sp.symbols("x")
		>>> sp.series(1/(1-x), x, x0=0, n=7)
		1 + x + x**2 + x**3 + x**4 + x**5 + x**6 + O(x**7)
		>>> sp.series(1/(1+x), x, x0=0, n=7)
		1 - x + x**2 - x**3 + x**4 - x**5 + x**6 + O(x**7)
		>>> sp.series(sp.E**x, x, x0=0, n=6)
		1 + x + x**2/2 + x**3/6 + x**4/24 + x**5/120 + O(x**6)
		>>> sp.series(sp.sin(x), x, x0=0, n=8)
		x - x**3/6 + x**5/120 - x**7/5040 + O(x**8)
		>>> sp.series(sp.cos(x), x, x0=0, n=8)
		1 - x**2/2 + x**4/24 - x**6/720 + O(x**8)
		>>> sp.series(sp.ln(x+1), x, x0=0, n=6)
		x - x**2/2 + x**3/3 - x**4/4 + x**5/5 + O(x**6)
		\end{codeblock}
		
		\noindent
		The big-O notation \tt{O(x**n)} appears in all the above outputs
		as a reminder that the exact Taylor series contains additional terms,
		and the Taylor series approximations shows are
		only accurate up to an error on the \emph{order of} $x^n$.		% TODO: REVISIT THIS




	\subsection{Applications of series}
	\label{series:applications}

		%	We've already seen we can approximate the value of $e$
		%	using the series $\sum_{k=0}^{20} f_k = \tt{sum([f_k(k) for k in range(0,15)])}$.
		%	Now that we know the Taylor series of $e^x$,
		%	we can also compute $e^5$ 

		The Taylor series representation for the function $f(x)$
		provides a relatively easy way
		to compute its integral function $F_0(x) \eqdef \int_0^x f(u)\,du$.
		% for any function $f(x)$.
		The Taylor series of $f(x)$ consists only of polynomial terms of the form $c_n x^n$.
		%	We can compute the derivative function $f'(x)$
		%	by simply computing the derivative of each term: $nc_n x^{n-1}$.
		To compute the integral function $F_0(x) \eqdef \int_0^x f(u)\,du$,
		we can compute the integrals of the individual terms,
		which gives us $\frac{c_n}{n+1}x^{n+1}$.
		For example,
		if we want to compute the integral of $\cos(x)$,
		$\int \cos(x) \, dx =  ??$.
		\[
			a
		\]
		we can recognize this is the series for $\sin(x)$,
		so we conclude that $\int \cos(x) \, dx = \sin(x)$.

		
		%	This example is of historical importance,
		%	since it was issued as challenge by Isaac Newton to Wilhelm Leibnitz.
		%	No formulas for the integral of ln x was not know at the time,
		%	and was considered a difficult computation problem.
		%	Newton had discover the Taylor series approximation formula 
		%	for ln x
		%	but had not published his result.
		%	A bit like closed source software.
		%	Leibniz had independently discovered calculus and series
		%	so he was able to compute the answer.
		%	When Newton saw that Leibniz was able to solve the challenge,
		%	he was motivated to publish his results,
		%	which is why we still credit calculus to him.


		% MAYBE: ODEs ?


	\ifthenelse{\boolean{FORSTATSBOOK}}{
		While we're on the topic of series,
		I want to show you some extra series formulas and tricks
		that you need to know to solve the exercises ???? and problems ??? in Chapter~2.
	}{}







% CUT MATERIAL

% NOTEBOOK ONLY
%	We define a sequence by specifying an expression for its $n$\textsuperscript{th} term:
%	
%	
%	\begin{codeblock}[]
%	>>> k = sp.symbols("k")
%	>>> a_k = 1 / k
%	>>> b_k = 1 / sp.factorial(k)
%	\end{codeblock}
%	
%	\noindent
%	Substitute the desired value of $n$ to see the value of the $n$\textsuperscript{th} term:
%	
%	\begin{codeblock}[]
%	>>> a_k.subs({k:5})
%	1/5
%	\end{codeblock}
%	
%	\noindent
%	%We can use 
%	The Python list comprehension syntax \texttt{[item for item in list]}
%	can be used to print the sequence values for some range of indices:
%	
%	
%	
%	\begin{codeblock}[]
%	>>> [ a_k.subs({k:i}) for i in range(1,8) ]
%	[1, 1/2, 1/3, 1/4,  1/5,   1/6,   1/7]  
%	>>> [ b_k.subs({k:i}) for i in range(0,8) ]
%	[1,  1, 1/2, 1/6, 1/24, 1/120, 1/720, 1/5040]
%	\end{codeblock}
%	
%	\noindent
%	Observe that $a_k$ is not defined for $k=0$
%	since $\frac{1}{0}$ is a division-by-zero error.
%	In other words,
%	the domain of $a_k$ is the nonnegative natural numbers $a_k:\mathbb{N}_+ \to \mathbb{R}$.
%	Observe how quickly the `factorial` function $k!=1\cdot2\cdot3\cdots(k-1)\cdot k$ grows:
%	$7!= 5040$, $10!=3628800$, $20! > 10^{18}$.
%	
%	We're often interested in calculating the limits of sequences as $k\to \infty$.
%	What happens to the terms in the sequence when $k$ becomes large?
%	
%	\begin{codeblock}[]
%	>>> sp.limit(a_k, k, sp.oo)
%	0
%	>>> sp.limit(b_k, k, sp.oo)
%	0
%	\end{codeblock}
%	
%	\noindent
%	Both $a_k=\frac{1}{k}$ and $b_k = \frac{1}{k!}$ \emph{converge} to $0$ as $k \to \infty$.




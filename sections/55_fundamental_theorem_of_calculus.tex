%!TEX root = ../calculus_tutorial.tex



	\subsection{Fundamental theorem of calculus}
	
		The fundamental theorem of calculus (FTC) is a deep insight about the
		inverse relation that exists between the operations of integration $\int \cdot dx$
		and differentiation $\frac{d}{dx}[\cdot]$.

		%	The integral function $F_a(x)$ is obtained from the original function $f(x)$ using integration,
		%	$F_a(x) = \int_a^x f(u) du$.
		%	Another way to describe this is to say we \emph{applied} the integration operator $\int \cdot dx$
		%	on the function $f(x)$ to obtain the integral function $F_a(x)$.
		%	The derivative function $f'(x)$ is defined by the formula $f'(x) = \lim_{\delta \to 0} \frac{f(x+\delta)\ - \ f(x)}{\delta}$.
		%	We can also say we \emph{applied} the derivative operator $\frac{d}{dx}[\cdot]$
		%	to the function $f(x)$ to obtain the derivative function $f'(x)$.
		%	I use the word ``operator'' here to refer to an operation that acts on functions.

		A priori,
		there is no reason to suspect the integral function would be related to the derivative operation.
		The integral corresponds to the computation of an area,
		whereas the derivative operation computes the slope of a function.
		The fundamental theorem of calculus describes the relationship between
		derivatives and integrals.

		\begin{shadetheorem}[fundamental theorem of calculus]
			Let $f(x)$  be a continuous function on the interval $[a,b]$,										\index{continuous function}
			and let $\alpha \in \mathbb{R}$ be a constant.
			Define the function $F_\alpha(x)$ as follows:
			\[
				F_\alpha(x)  \equiv A_f(\alpha, x) =  \int_\alpha^x f(u) \: du.
			\]
			Then, the derivative of $F_\alpha(x)$ with respect to $x$ is equal to $f(x)$:
			\[
				\frac{d}{dx}\!\big[F_\alpha(x)\big] = f(x),
			\]
			for any $x \in (a,b)$.
		\end{shadetheorem}

		%	The fundamental theorem of calculus establishes an equivalence between the set 
		%	of integral functions and the set of antiderivative functions:
		%	\[
		%		A_\alpha(x)=F(x)+C.
		%	\]
		%	All integral functions $F_\alpha(x)$ are antiderivatives of $f(x)$.
	
		Differential calculus and integral calculus are two sides of the same coin.
		If you understand why the theorem is true, 
		you will understand something very deep about calculus. 
		Differentiation is the inverse operation of integration.


		%	There is no reason \emph{a priori} to think that integration and differentiation might be related:
		%	the former is a calculation about areas,
		%	while the latter is a calculation about slopes.
		%	The fundamental theorem of calculus reveals that they are in fact inverse operations:
		%	we can obtain the original function $f(x)$ from the integral function $F_a(x)$ by computing it's derivative:
		%	\[
		%		\frac{d}{dx}\big[F_a(x)\big] 	= 	\frac{d}{dx}\left[\int_a^x f(u) \; du \right]  	= 	f(x).
		%	\]
		%	Note we used a temporary variable $u$ as the integration variable,
		%	since $x$ is already used to denote the upper limit of integration.

		In order to understand the inverse relationship between integration and differentiation,
		we can draw an analogy with the inverse relationship between a function $f$ and its inverse function $f^{-1}$,
		which \emph{undoes} the effects of $f$.
		See Figure~\ref{fig:functions-inverse} on page~\pageref{fig:functions-inverse}.
		Given some initial value $x$,
		if we apply the function $f$ to obtain the number $f(x)$,
		and apply the inverse function $f^{-1}$ on the number $f(x)$,
		then the result will be the initial value $x$ we started from:
		\[
			f^{-1}\!\left( f(x) \right)	=	x.
		\]
		Similarly,
		\textbf{the derivative operation is the inverse of the integral operation}.
		If you perform the integral operation followed by the derivative operation on some function,
		you'll get back to original function:
		\[
			\frac{d}{dx} \int_c^x f(u)\:du = f(x).
		\]

		% VERIFY USING SYMPY
		\noindent
		Let's use SymPy to verify the fundamental theorem of calculus.
		Recall that the function \tt{sp.diff} compute the derivative functions
		and \tt{sp.integrate} computes integral functions.
		To verify $\int_c^x F'(u)\;du = F(x) + C$,
		we start with some expression \tt{Fx} for the function $F(x) = x^3$.

		\begin{codeblock}[]
		>>> F = x**3
		>>> dFdx = diff(F, x)
		>>> dFdx
		3*x**2
		>>> integrate(dFdx, x)
		x**3    # + C
		\end{codeblock}

		
		% DIRECTION 2
		For ordinary math functions,
		we know that if the function $f^{-1}$ is the undo action for the function $f$,
		then $f$ is also the undo action for $f^{-1}$:
		$f\!\left( f^{-1}(y) \right) = y$.
		Similarly,
		the inverse relationship between integrals and derivative holds in the other direction too.
		%	Going back to the analogy with ordinary math functions,
		% if we apply $f^{-1}$ followed by $f$,
		% we get back the original number we started from:
		\textbf{The  integral operation is the inverse operator of the derivative operation}.
		If we start with some function $F(x)$,
		calculate the derivative function $F'(x)$,
		then compute the integral of the derivative function $F'(x)$,
		we arrive back at the original function $F(x)$
		(up to an additive constant):
		\[
			F(x) = \int_c^x F'(u)\;du = F(x) + C.
		\]
		% The constant $C$ 
		%  choice of the starting point for integration


		We can verify this using SymPy
		by starting with some function $\tt{f} = f(x) = x^2$,
		computing its integral function using \tt{sp.integrate}
		then take the derivative:

		\begin{codeblock}[]
		>>> f = x**2
		>>> F = integrate(f, x)
		>>> F
		x**3/3           # + C
		>>> diff(F, x)
		x**2
		\end{codeblock}

%		if you compute the derivative of a function followed by the integral,
%		you will obtain the original function $f(x)$ (up to a constant):
%		\[
%		  \left( \int dx \circ \frac{d}{dx}\right) f(x) = \int_c^x f'(u)\;du = f(x) + C.
%		\]










		\subsubsection{Using integrals by reverse engineering derivatives}
  
	  		% ALT. by anti-differentiation
			The fundamental theorem of calculus
			gives us a way for computing integrals functions
			using ``reverse engineering'' thinking
			and using a table of derivative formulas
			(see page~\pageref{mathematical_preliminiaries:derivative_formulas}).
			To find an integral function of the function $f(x)$,
			we can look for a function $F(x)$
			whose derivative is the the function $f(x)$.
			% MAYBE: introduce noton of anti-derivatives
			If we can find such a function $F(x)$ such that $F'(x)=f(x)$,
			then we know the integral function of $f(x)$ is $F_c(x)$ 
			\[
				\int  f(x)\,dx = F(x). FIXME
			\]
			% MERGE
			%The fundamental theorem of calculus gives us a symbolic trick for computing
			%the integrals functions $\int f(x)\,dx$ for many simple functions.
			%If you can find a function $F(x)$ such that $F'(x) = f(x)$,
			%then 
	
			\paragraph{Example}
	
				Suppose you're given a function $f(x)$
				and asked to find its integral function $F(x) = \int  f(x)\: dx$.
				This fundamental theorem of calculus tells us this problem
				is equivalent to finding a function $F(x)$ whose derivative is $f(x)$: $F'(x) = f(x)$.
				For example,
				suppose you want to find the indefinite integral $\int x^2\,dx$.
				We can rephrase this problem as the search for some function $F(x)$ such that $F'(x) = x^2$.
				Remembering the derivative formulas we saw above,
				you guess that $F(x)$ must contain an $x^3$ term.
				Taking the derivative of a cubic term results in a quadratic term.
				Therefore, the function you are looking for has the form $F(x)=cx^3$,
				for some constant $c$.
				Pick the constant $c$ that makes this equation true: $F'(x) = 3cx^2 = x^2$.
				Solving $3c=1$, we find $c=\frac{1}{3}$ and so the integral function is $F(x) = \int x^2 \:dx = \frac{1}{3}x^3 + C$.
				In other words,
				the area under the graph of $f(x)=x^2$ is described by the family of functions $F(x) = \frac{1}{3}x^3 + C$.
	% The constant $C$ varies depending on the choice of lower limit of integration $\alpha$ for the area calculation $A_f(\alpha, x)$.
	% You can verify that $\frac{d}{dx}\left[\frac{1}{3}x^3 + C\right] = x^2$.
	


		%	The integral is the ``inverse operation'' of the derivative.
		%	If you perform the integral operation followed by the derivative operation on some function, 
		%	you'll obtain the same function:
		%	Note we need a new variable $u$ inside the integral since $x$ is already 
		%	used to denote the upper limit of integration.

		% That's kind of cool, no?
		% TODO: mention application integration by finding anti-derivative functions
		% TODO: explain what it means for integral not to have closed form


		\subsubsection{Using derivative formulas in reverse}
		
			This procedure based on using the derivative formulas
			in reverse to guess the value of $F(x)$
			is very useful.
			
			We can use it for all the function listed in the table.
			
			For example,
			the table tells us that the derivative of the linear function $f(x) = mx+b$
			is the constant function $f'(x) = m$,
			which means the integral of a constant function is a linear function
			$\int m\,dx = mx + C$.
			The integral of ..
			therefor 

\vspace{1in}

			We can easily verify all these integral formulas
			using SymPy to compute
			the integral of a complicated function 
			$f(x) = m + e^x + \frac{1}{x} + \cos(x) - \sin(x)$,
			which contain a mix of all the expression we see on the right side of the table:

			\begin{codeblock}[]
			>>> fx = m + sp.exp(x) + 1/x + sp.cos(x) - sp.sin(x)
			>>> sp.integrate(fx, x)
			m*x + exp(x) + log(x) + sin(x) + cos(x)
			\end{codeblock}
			
			
			\noindent
			SymPy tells us the integral function
			$F_0$ is $F_0(x) = mx + e^x + log(x) + sin(x) + cos(x)$,
			% $F_0(b) = mb + e^b + log(b) + sin(b) + cos(b)$,
			which are all the corresponding terms on the left side of the table.



%LEAD OUT: what do we do when there is no simple formula?
\bigskip
Okay,
but what do we do if the function we want to integrate
doesn't appear on the right side of the table?




		\ifthenelse{\boolean{FORSTATSBOOK}}{

			\noindent
			In probability theory,
			the FTC tells us that the probability density can be obtained from the cumulative distribution using differentiation
			\[
				f_X(x) = \frac{d}{dx}\!\left[ F_X(x) \right] = \frac{dF_X}{dx}(x) = F'_X(x).
			\]
			The fact that we can obtain $f_X$ from $F_X$ and vice versa,
			means we only need to define one of the two functions,
			and obtain the other function using differentiation or integration.
			In this book,
			we define the random variable $X$ through its probability distribution function $f_X$,
			then define $F_X$ as the integral of $f_X$.
			In other books,
			you might see the random variable $X$ being defined through its cumulative distribution function $F_X$,
			with its probability density function $f_X$ defined as the derivative of $F_X$.

		}{}
